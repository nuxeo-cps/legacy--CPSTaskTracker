<tal:block define="current_action string:edit;
                   create options/create|nothing">
<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master">
  <metal:block fill-slot="base">
    <base href="." tal:attributes="href string:${here/absolute_url}/">
  </metal:block>
<body>


<metal:block fill-slot="header">
  <tal:block condition="create"
    tal:content="python:mcat('heading_edit_task')">
    Upload a File
  </tal:block>
  <tal:block condition="not:create">
    <tal:block replace="python:mcat('_Modify_(object name)_')">
      Modify
    </tal:block>
    «&nbsp;<span tal:replace="here/title_or_id">Title</span>&nbsp;»
  </tal:block>
</metal:block>

<metal:block fill-slot="header_plus" />

<metal:block fill-slot="main"
  tal:define="title python:(create and [''] or [here.Title()])[0];
                 description python:(create and [''] or [here.Description()])[0];
                 submitvalue python:create and mcat('_button_create_') or mcat('_button_modify_');
                 action python:create and 'cpsdocument_create' or 'cpsdocument_edit';
                ">

  <form action="." method="post" enctype="multipart/form-data"
        tal:attributes="action action">

  <metal:block use-macro="here/main_widgets/macros/form">
    <metal:block fill-slot="content">
      <metal:block use-macro="here/main_widgets/macros/form_property">
        <metal:block fill-slot="title"
          tal:content="python:mcat('_prop_title_')">
          Title
        </metal:block>
        <metal:block fill-slot="content">
          <input type="text" name="title" value="title" tal:attributes="value title" />
        </metal:block>
      </metal:block>

      <metal:block use-macro="here/main_widgets/macros/form_property">
        <metal:block fill-slot="title"
          tal:content="string:Task Start">
          Start
        </metal:block>
        <metal:block fill-slot="content">
          <input type="text" name="start_task_date" value=""
                 tal:attributes="value here/start_task_date|nothing" />
        </metal:block>
      </metal:block>

      <metal:block use-macro="here/main_widgets/macros/form_property">
        <metal:block fill-slot="title"
          tal:content="string:Task Deadline">
          Task Deadline
        </metal:block>
        <metal:block fill-slot="content">
          <input type="text" name="stop_task_date" value=""
                 tal:attributes="value here/stop_task_date|nothing" />
        </metal:block>
      </metal:block>

      <metal:block use-macro="here/main_widgets/macros/form_property">
        <metal:block fill-slot="title"
          tal:content="string:Task Priority">
          Task Priority
        </metal:block>
        <metal:block fill-slot="content">
          <select name="task_priority"
                  tal:define="the_priority here/task_priority|nothing">

            <option value="high" tal:content="string:high"
                    tal:condition="python:the_priority !='high'">high</option>
            <option value="high" tal:content="string:high" selected
                    tal:condition="python:the_priority=='high'">high</option>

            <option value="normal" tal:content="string:normal"
                    tal:condition="python:the_priority !='normal'">normal</option>
            <option value="normal" tal:content="string:normal" selected
                    tal:condition="python:the_priority =='normal'">normal</option>

            <option value="low" tal:content="string:low"
                    tal:condition="python:the_priority !='low'">low</option>
            <option value="low" tal:content="string:low" selected
                    tal:condition="python:the_priority =='low'">low</option>
          </select>
        </metal:block>
      </metal:block>

      <metal:block use-macro="here/main_widgets/macros/form_property">
        <metal:block fill-slot="title"
          tal:content="string:Task Indicator">
          Task Priority
        </metal:block>
        <metal:block fill-slot="content">
          <select name="task_indicator"
                  tal:define="the_indicator here/task_indicator|nothing">

            <option value="normal" tal:content="string:normal"
                    tal:condition="python:the_indicator != 'normal'">normal</option>
            <option value="normal" tal:content="string:normal" selected
                    tal:condition="python:the_indicator == 'normal'">normal</option>

            <option value="critical" tal:content="string:critical"
                    tal:condition="python:the_indicator !='critical'">critical</option>
            <option value="critical" tal:content="string:critical" selected
                    tal:condition="python:the_indicator == 'critical'">critical</option>

            <option value="late" tal:content="string:late"
                    tal:condition="python:the_indicator != 'late'">late</option>
            <option value="late" tal:content="string:late" selected
                    tal:condition="python:the_indicator == 'late'">late</option>

          </select>
        </metal:block>
       </metal:block>

      <metal:block use-macro="here/main_widgets/macros/form_property">
        <metal:block fill-slot="title"
          tal:content="string:Task Type">
          Task Priority
        </metal:block>
        <metal:block fill-slot="content">
          <select name="task_type"
                  tal:define="the_type here/task_type|nothing">
            <tal:block repeat="type python:here.getTaskTypes()">
              <option value="."
                      tal:condition="python:the_type != type"
                      tal:attributes="value type"
                      tal:content="type">
                Task Type
              </option>
              <option value="." selected
                      tal:condition="python:the_type == type"
                      tal:attributes="value type"
                      tal:content="type">
                Task Type
              </option>
            </tal:block>
          </select>
        </metal:block>
      </metal:block>

      <metal:block use-macro="here/main_widgets/macros/form_property">
        <metal:block fill-slot="title"
                     tal:content="string:Task Assigned To Users">
                      Task Assigned To Users
        </metal:block>
        <metal:block fill-slot="content">
          <textarea readonly id="members"
                    name="members:text"
                    rows="3" cols="30" tal:content="here/getMembersAsText|nothing"></textarea>
          <input type="hidden" size="1" value=""
                 id="hidden_members"
                 name="members">

          <script language="JavaScript" type="text/javascript"><!--

             function open_mb_selector(input_id) {

               ids = document.getElementById('hidden_'+input_id).value.replace(/\n/g,'$$$$');
               fulls = document.getElementById(input_id).value.replace(/\n/g,'$$$$');
               ids = ids.substring(0, ids.length-2);
               fulls = fulls.substring(0, fulls.length-2); // $$
               args = 'input_id='+input_id+'&ids='+ids+'&fulls='+fulls;

               selector_window = window.open('members_edit_form?'+args, 'members', 'toolbar=0, scrollbars=0, location=0, statusbar=0,menubar=0, resizable=1, dependent=1, width=450, height=420')


               if(!selector_window.opener) selector_window.opener = window
             }

             function clean_textarea_user(input_id) {
               c = document.getElementById(input_id);
               c.value = '';
               d = document.getElementById('hidden_'+input_id);
               d.value = '';

             }

           -->
           </script>

           <a href="javascript:open_mb_selector('members')">
            <img border="0" src="img_box_edit.png" />
           </a>
         </metal:block>
      </metal:block>

      <metal:block use-macro="here/main_widgets/macros/form_property">
        <metal:block fill-slot="title"
                     tal:content="string:Task Assigned To Groups">
                     Task Assigned To Groups
        </metal:block>
        <metal:block fill-slot="content">
          <textarea readonly id="groups"
                    name="groups:text"
                    rows="3" cols="30" tal:content="here/getGroupsAsText|nothing"></textarea>
          <input type="hidden" size="1" value=""
                 id="hidden_groups"
                 name="groups">
          <script language="JavaScript" type="text/javascript"><!--

             function open_gr_selector(input_id) {

               ids = document.getElementById('hidden_'+input_id).value.replace(/\n/g,'$$$$');
               fulls = document.getElementById(input_id).value.replace(/\n/g,'$$$$');
               ids = ids.substring(0, ids.length-2);
               fulls = fulls.substring(0, fulls.length-2); // $$

               args = 'input_id='+input_id+'&ids='+ids+'&fulls='+fulls;

               selector_window = window.open('groups_edit_form?'+args,'members', 'toolbar=0, scrollbars=0, location=0, statusbar=0,menubar=0, resizable=1, dependent=1, width=450, height=420')


               if(!selector_window.opener) selector_window.opener = window
             }

             function clean_textarea_user(input_id) {
               c = document.getElementById(input_id);
               c.value = '';
               d = document.getElementById('hidden_'+input_id);
               d.value = '';

             }

           -->
           </script>
          <a href="javascript:open_gr_selector('groups')">
            <img border="0" src="img_box_edit.png" />
           </a>
       </metal:block>
      </metal:block>

      <metal:block use-macro="here/main_widgets/macros/form_property">
        <metal:block fill-slot="title"
          tal:content="string:Task Project">
          Task Project
        </metal:block>
        <metal:block fill-slot="content">
          <textarea name="task_project:text" rows="5" cols="50" wrap="soft"
                    tal:content="here/task_project|nothing"></textarea>
        </metal:block>
      </metal:block>

      <metal:block use-macro="here/main_widgets/macros/form_property">
        <metal:block fill-slot="title"
          tal:content="string:Task Goal">
          Task Goal
        </metal:block>
        <metal:block fill-slot="content">
          <textarea name="task_goal:text" rows="5" cols="50" wrap="soft"
                    tal:content="here/task_goal|nothing"></textarea>
        </metal:block>
      </metal:block>

      <metal:block use-macro="here/main_widgets/macros/linkswidget">
          Related links
      </metal:block>

      <metal:block use-macro="here/main_widgets/macros/form_property">
        <metal:block fill-slot="title"
          tal:content="string:Task references">
          References (Documents)
        </metal:block>

        <metal:block fill-slot="content">
          <tal:block condition="create">
            <input type="file" name="file" size="25" />
          </tal:block>
          <tal:block condition="not:create">
            <p><tal:block replace="python:mcat('_Currently:')">
                Currently:</tal:block>
              <tal:block condition="here/filename" replace="here/filename">Filename</tal:block>
              <tal:block condition="not:here/filename"
                tal:replace="python:mcat('_(document)_Untitled_')">
                Untitled
              </tal:block>
            </p>
            <tal:block define="name string:file; deletable nothing">
              <metal:block use-macro="here/main_widgets/macros/binary_input">Binary in
put</metal:block>
            </tal:block>
          </tal:block>
        </metal:block>
      </metal:block>


   </metal:block>
 </metal:block>



  <input type="hidden" name="type_name" value="CPS Task">
  <tal:block condition="create">
    <input type="hidden" name="default_id_from" value="title" />
    <input type="hidden" name="default_title_from" value="description" />
  </tal:block>
  <input class="mainbutton" type="submit" value="." tal:attributes="value submitvalue">
  <input class="mainbutton" type="button" name="cancel" onclick="history.back()"
    tal:attributes="value python:mcat('_button_cancel_')">

  </form>

</metal:block>


</body>
</html>
</tal:block>
